#!/bin/bash

# RuleWeaver Build Script
# Builds the production distribution

set -e

echo "ğŸ”¨ Building RuleWeaver..."
echo ""

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
    echo "ğŸ“¦ Installing dependencies..."
    npm install
    echo ""
fi

# Run linting
echo "ğŸ” Running linters..."
npm run lint
npm run lint:rust
echo ""

# Run type checks
echo "ğŸ“‹ Running type checks..."
npm run typecheck
echo ""

# Run tests
echo "ğŸ§ª Running tests..."
npm run test
npm run test:rust
echo ""

# Build the application
echo "ğŸ—ï¸  Building production bundle..."
npm run tauri:build

echo ""
echo "âœ… Build complete!"
echo "ğŸ“ Distribution files are in src-tauri/target/release/bundle/"
